purchase_colony = {
	category = economy
	
	#require_acceptance = yes
	
	is_visible = {
		NOT = { current_age = age_of_discovery }
		has_idea_group = exploration_ideas
		ai = no
		NOT = { has_country_flag = colony_seller }
		FROM = {
			NOT = { has_country_flag = colony_seller }
			OR = {
				technology_group = western
				technology_group = eastern
				technology_group = ottoman
			}
			OR = {
				AND = {
					capital_scope = { continent = europe }
					any_country = {
						capital_scope = { OR = { continent = north_america continent = south_america colonial_region = colonial_australia colonial_region = colonial_nz } }
						is_colonial_nation_of = FROM
						is_subject_of = FROM
					}
				}
				AND = {
					capital_scope = { continent = europe }
					any_owned_province = {
				#		owned_by = FROM 
						is_city = yes	
						OR = { continent = north_america continent = south_america colonial_region = colonial_australia colonial_region = colonial_nz }
					}
				}
			}
		} 
	}
	is_allowed = {
		is_subject = no
		FROM = { is_subject = no }
	}
	
	on_accept = {
		FROM = { set_country_flag = colony_seller }
		ROOT = { country_event = { id = colony_buysell.300 days = 0 } }
		
	}
	on_decline = {
		add_trust = {
			who = FROM
			value = -5
			mutual = no
		}
	}
	#ai_acceptance = {
	#	add_entry = {
	#		name = INITIAL
	#		export_to_variable = {
	#			variable_name = ai_value
	#			value = 0
	#			who = FROM
	#			with = THIS
	#		}
	#		subtract_variable = { which = ai_value value = 25 }
	#	}
	#	add_entry = {
	#		name = OPINION
	#		export_to_variable = {
	#			variable_name = ai_value
	#			value = opinion
	#			who = FROM
	#			with = THIS
	#		}
	#	}
	#}
	ai_will_do = {
		always = no
	}
}


offer_fief = {
	category = influence
	
	require_acceptance = yes
	
	is_visible = {
		current_age = age_of_discovery
		OR = {
			technology_group = western
			technology_group = eastern
			technology_group = ottoman
			technology_group = muslim
		}
		FROM = {
			is_subject_of = ROOT
			is_colony = no
			is_lesser_in_union = no
			NOT = { is_subject_of_type = fief }
			NOT = { is_subject_of_type = canton }
			NOT = { is_subject_of_type = dominion }
			NOT = { is_subject_of_type = league }
			OR = {
				technology_group = western
				technology_group = eastern
				technology_group = ottoman
				technology_group = muslim
			}
		}
	}
	is_allowed = {
		FROM = {
			NOT = { num_of_cities = 9 }
		}
	}
	
	on_accept = {
		create_subject = {
			subject_type = fief
			subject = FROM
		}
	}
	on_decline = {
		add_trust = {
			who = FROM
			value = -10
			mutual = no
		}
	}
	ai_acceptance = {
		add_entry = {
			name = INITIAL
			export_to_variable = {
				variable_name = ai_value
				value = 0
				who = FROM
				with = THIS
			}
			subtract_variable = { which = ai_value value = 25 }
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				variable_name = ai_value
				value = opinion
				who = FROM
				with = THIS
			}
		}
		add_entry = {
			name = SUBJECT_SIZE
			export_to_variable = {
				variable_name = ai_value
				value = num_of_cities
				who = FROM
				with = THIS
			}
			multiply_variable = { which = ai_value value = -1 }
			multiply_variable = { which = ai_value value = 20 }
		}
	}
	ai_will_do = {
		factor = 100
	}
	ai_importance = 400
}
cancel_fief = {
	category = influence
	
	require_acceptance = no
	
	is_visible = {
		overlord_of = FROM
		FROM = {
			is_subject_of_type = fief
		}
	}
	is_allowed = {
		legitimacy_equivalent = 100
	}
	on_accept = {
		create_vassal = FROM
		add_legitimacy = -10
	}
	ai_will_do = {
		factor = 100
		modifier = {
			factor = 0
			NOT = { legitimacy_equivalent = 100 }
		}
		modifier = {
			factor = 0
			FROM = { num_of_cities = 1 NOT = { num_of_cities = 9 } }
		}
	}
}

seize_fief = {
	category = influence
	
	require_acceptance = yes	
	
	is_visible = {
		current_age = age_of_discovery
		OR = {
			technology_group = western
			technology_group = eastern
			technology_group = ottoman
			technology_group = muslim
		}
		if = {
			limit = { OR = { tag = ENG tag = FRA } NOT = { has_global_flag = HYW_end } }
			FROM = {
				NOT = { is_subject_of = ROOT }
				OR = { 
					culture_group = british
					culture_group = french
				}
				religion_group = ROOT
				is_subject_of_type = fief
				OR = {
					technology_group = western
					technology_group = eastern
					technology_group = ottoman
					technology_group = muslim
				}
			}
		}
		else = { 
			FROM = {
				NOT = { is_subject_of = ROOT }
				culture_group = ROOT
				religion_group = ROOT
				is_subject_of_type = fief
				OR = {
					technology_group = western
					technology_group = eastern
					technology_group = ottoman
					technology_group = muslim
				}
			}
		}
		
	}
	is_allowed = {
		custom_trigger_tooltip = {
			tooltip = fief.tooltip
			legitimacy = 0
			FROM = {
				war_with = ROOT 
				is_subject_of_type = fief
				capital_scope = { controlled_by = ROOT }
				NOT = { total_development = ROOT }
			}
			
		}
	}
	
	on_accept = {
		add_legitimacy = -10
		hidden_effect = { 
			FROM = { 
				overlord = {
					reverse_add_opinion = {
    					who = ROOT
    					modifier = took_fief
					}
				}
				reverse_add_opinion = {
    				who = ROOT
    				modifier = forced_fief
				}
			}
		}
		create_subject = {
			subject_type = fief
			subject = FROM
		}
	}
	on_decline = {
		add_trust = {
			who = FROM
			value = -10
			mutual = no
		}
	}
	ai_acceptance = {
		add_entry = {
			name = INITIAL_VASSAL
			limit = {
				FROM = { is_subject = yes }
			}
			export_to_variable = {
				variable_name = ai_value
				value = 0
				who = FROM
				with = THIS
			}
			subtract_variable = { which = ai_value value = 25 }
		}
		add_entry = {
			name = CAPITAL_CONTROLLED
			limit = {
				FROM = { capital_scope = { controlled_by = ROOT } }
			}
			export_to_variable = {
				variable_name = ai_value
				value = 200
				who = FROM
				with = THIS
			}
		}
		add_entry = {
			name = NO_BORDER_PROV
			limit = {
				NOT = { is_neighbor_of = FROM  }
			}
			export_to_variable = {
				variable_name = ai_value
				value = -1000
				who = FROM
				with = THIS
			}
		}
	}
	ai_will_do = {
		factor = 100
	}
}


seize_dominion = {
	category = great_powers
	
	require_acceptance = yes	
	
	is_visible = {
		is_great_power = yes
		OR = {
			technology_group = western
			technology_group = eastern
			technology_group = ottoman
			technology_group = muslim
		}
		FROM = {
			NOT = { is_subject_of = ROOT }
			is_subject_of_type = dominion
			overlord = { 
				OR = {
					AND = {
						is_rival = ROOT
						is_great_power = yes
					}
					is_great_power = no
				}
			}
			OR = {
				technology_group = western
				technology_group = eastern
				technology_group = ottoman
				technology_group = muslim
			}
		}
	}
	is_allowed = {
		custom_trigger_tooltip = {
			tooltip = dominion.tooltip
			FROM = {
				war_with = ROOT 
				is_subject_of_type = dominion
				capital_scope = { controlled_by = ROOT }
				NOT = { total_development = ROOT }
			}
			
		}
	}
	
	on_accept = {
		hidden_effect = { 
			FROM = { 
				overlord = {
					reverse_add_opinion = {
    					who = ROOT
    					modifier = took_dominion
					}
				}
				reverse_add_opinion = {
    				who = ROOT
    				modifier = forced_dominion
				}
			}
		}
		create_subject = {
			subject_type = dominion
			subject = FROM
		}
	}
	on_decline = {
		add_trust = {
			who = FROM
			value = -10
			mutual = no
		}
	}
	ai_acceptance = {
		add_entry = {
			name = INITIAL_VASSAL
			limit = {
				FROM = { is_subject = yes }
			}
			export_to_variable = {
				variable_name = ai_value
				value = 0
				who = FROM
				with = THIS
			}
			subtract_variable = { which = ai_value value = 25 }
		}
		add_entry = {
			name = CAPITAL_CONTROLLED
			limit = {
				FROM = { capital_scope = { controlled_by = ROOT } }
			}
			export_to_variable = {
				variable_name = ai_value
				value = 200
				who = FROM
				with = THIS
			}
		}
		add_entry = {
			name = NO_BORDER_PROV
			limit = {
				NOT = { is_neighbor_of = FROM }
			}
			export_to_variable = {
				variable_name = ai_value
				value = -1000
				who = FROM
				with = THIS
			}
		}
	}
	ai_will_do = {
		factor = 100
	}
}
