#Amyzonis' AN overhaul of formables

country_decisions = {

#### Post-Discovery Formables	 
# Spain	 
AN_spain_nation = { 
	major = yes
	potential = {
		NOT = { has_country_flag = formed_spain_flag }
		SPA = { exists = no }
		IBE = { exists = no }
		NOT = { 
			OR = { 
				government = native 
				government = tribal 
				tag = LSA
				tag = ADU
				tag = OCC
				tag = FRA
			}
			religion_group = muslim #Andalusia for Muslims
		}
		OR = {
			primary_culture = castillian	
			primary_culture = asturian
			primary_culture = extremaduran
			primary_culture = aragonese
			primary_culture = catalan
			primary_culture = leonese
		}
	}
	provinces_to_highlight = {
		province_group = spain_group
	}
	allow = {
		NOT = { current_age = age_of_discovery }
		is_at_war = no
		
		if = { 
			limit = { OR = { tag = CAS tag = LON } }
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				province_group = spain_group
				value = 20 #?
			}
			220 = { country_or_non_sovereign_subject_holds = ROOT }
			333 = { country_or_non_sovereign_subject_holds = ROOT }
			214 = { country_or_non_sovereign_subject_holds = ROOT }
			213 = { country_or_non_sovereign_subject_holds = ROOT }
		}
		if = { limit = { tag = ARA } 
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				province_group = spain_group
				value = 20 #?
			}
			1746 = { country_or_non_sovereign_subject_holds = ROOT }
			217 = { country_or_non_sovereign_subject_holds = ROOT }
			219 = { country_or_non_sovereign_subject_holds = ROOT }
			208 = { country_or_non_sovereign_subject_holds = ROOT }
		}
	}
	effect = {
		#Integrate PUs, Domains, Fiefs
		every_subject_country = { 
			limit = { capital_scope = { province_group = spain_group } OR = { is_subject_of_type = personal_union is_subject_of_type = dominion is_subject_of_type = fief } }
			ROOT = { inherit = PREV }
		}
		
		#Change Tag
		change_tag = SPA	
		
		#Set Govt Rank	
		if = { 
			limit = { NOT = { government_rank = 4 } }
			set_government_rank = 4
		}
		
		#Rewards
		add_prestige = 25
		add_country_modifier = {
			name = centralization_modifier
			duration = 7300
		}
		
		#Change Ideas
		if = {
			limit = {
				has_custom_ideas = no
				NOT = { has_idea_group = SPA_ideas }
			}
			country_event = { id = ideagroups.1 } #Swap Ideas
		}
		
		#Disable decision
		set_country_flag = formed_spain_flag
	}
	ai_will_do = {
		factor = 1
	}
	ai_importance = 400 #
}
	
# Lusitania	
AN_lusitania_nation = { 
	major = yes
	potential = {
		NOT = { has_country_flag = formed_lusitania_flag }
		LSA = { exists = no }
		IBE = { exists = no }
		NOT = { 
			OR = { 
				government = native 
				government = tribal 
				tag = SPA
				tag = ADU
				tag = OCC
				tag = FRA
			}
			religion_group = muslim #Andalusia for Muslims
		}
		OR = {
			primary_culture = portugese
			primary_culture = galician
		}
	}
	provinces_to_highlight = {
		province_group = lusitania_group
	}
	allow = {
		NOT = { current_age = age_of_discovery }
		is_at_war = no
		num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
			province_group = lusitania_group
			value = 36 #?
		}
		227 = { country_or_non_sovereign_subject_holds = ROOT }
		231 = { country_or_non_sovereign_subject_holds = ROOT }
		208 = { country_or_non_sovereign_subject_holds = ROOT }
		206 = { country_or_non_sovereign_subject_holds = ROOT }
	}
	effect = {
		#Integrate PUs, Domains, Fiefs
		every_subject_country = { 
			limit = { capital_scope = { province_group = lusitania_group } OR = { is_subject_of_type = personal_union is_subject_of_type = dominion is_subject_of_type = fief } }
			ROOT = { inherit = PREV }
		}
		
		#Change Tag
		change_tag = LSA	
		
		#Set Govt Rank	
		if = { 
			limit = { NOT = { government_rank = 4 } }
			set_government_rank = 4
		}
		
		#Rewards
		add_prestige = 25
		add_country_modifier = {
			name = centralization_modifier
			duration = 7300
		}
		
		#Change Ideas
		if = {
			limit = {
				has_custom_ideas = no
				NOT = { has_idea_group = LSA_ideas }
			}
			country_event = { id = ideagroups.1 } #Swap Ideas
		}
		
		#Disable decision
		set_country_flag = formed_lusitania_flag
	}
	ai_will_do = {
		factor = 1
	}
	ai_importance = 400 #
}

# Andalusia
AN_andalusia_nation = { 
	major = yes
	potential = {
		NOT = { has_country_flag = formed_andalusia_flag }
		ADU = { exists = no }
		IBE = { exists = no }
		NOT = { 
			OR = { 
				government = native 
				government = tribal 
				tag = SPA
				tag = LSA
				tag = OCC
				tag = FRA
			}
		}
		religion_group = muslim #Andalusia for Muslims
		OR = {
			primary_culture = andalusi_culture	
			primary_culture = andalucian
			AND = {
				culture_group = berber
				any_owned_province = { region = iberia_region }
			}
			AND = {
				culture_group = turko_semitic
				any_owned_province = { region = iberia_region }
			}
		}
	}
	provinces_to_highlight = {
		province_group = andalusia_group
	}
	allow = {
		NOT = { current_age = age_of_discovery }
		is_at_war = no
		num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
			province_group = andalusia_group
			value = 30 #?
		}
		223 = { country_or_non_sovereign_subject_holds = ROOT }
		224 = { country_or_non_sovereign_subject_holds = ROOT }
		225 = { country_or_non_sovereign_subject_holds = ROOT }
		1748 = { country_or_non_sovereign_subject_holds = ROOT }
		10012 = { country_or_non_sovereign_subject_holds = ROOT }
	}
	effect = {
		#Integrate PUs, Domains, Fiefs
		every_subject_country = { 
			limit = { capital_scope = { province_group = andalusia_group } OR = { is_subject_of_type = personal_union is_subject_of_type = dominion is_subject_of_type = fief } }
			ROOT = { inherit = PREV }
		}
		
		#Change Tag
		change_tag = ADU	
		
		#Set Govt Rank	
		if = { 
			limit = { NOT = { government_rank = 4 } }
			set_government_rank = 4
		}
		
		#Rewards
		add_prestige = 25
		add_country_modifier = {
			name = centralization_modifier
			duration = 7300
		}
		
		#Change Ideas
		if = {
			limit = {
				has_custom_ideas = no
				NOT = { has_idea_group = ADU_ideas }
			}
			country_event = { id = ideagroups.1 } #Swap Ideas
		}
		
		#Disable decision
		set_country_flag = formed_andalusia_flag
	}
	ai_will_do = {
		factor = 1
	}
	ai_importance = 400 #
}

# Occitania
AN_occitania_nation = { 
	major = yes
	potential = {
		NOT = { has_country_flag = formed_occitania_flag }
		OCC = { exists = no }
		IBE = { exists = no }
		NOT = { 
			OR = { 
				government = native 
				government = tribal 
				tag = SPA
				tag = LSA
				tag = ADU
				tag = FRA
			} 
		}
		culture_group = occitan
	}
	provinces_to_highlight = {
		province_group = occitania_group
	}
	allow = {
		NOT = { current_age = age_of_discovery }
		is_at_war = no
		num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
			province_group = occitania_group
			value = 30 #?
		}
		213 = { country_or_non_sovereign_subject_holds = ROOT }
		200 = { country_or_non_sovereign_subject_holds = ROOT }
		201 = { country_or_non_sovereign_subject_holds = ROOT }
		174 = { country_or_non_sovereign_subject_holds = ROOT }
	}
	effect = {
		#Integrate PUs, Domains, Fiefs
		every_subject_country = { 
			limit = { capital_scope = { province_group = occitania_group } OR = { is_subject_of_type = personal_union is_subject_of_type = dominion is_subject_of_type = fief } }
			ROOT = { inherit = PREV }
		}
		
		#Change Tag
		change_tag = OCC	
		
		#Set Govt Rank	
		if = { 
			limit = { NOT = { government_rank = 4 } }
			set_government_rank = 4
		}
		
		#Rewards
		add_prestige = 25
		add_country_modifier = {
			name = centralization_modifier
			duration = 7300
		}
		
		#Change Ideas
		if = {
			limit = {
				has_custom_ideas = no
				NOT = { has_idea_group = OCC_ideas }
			}
			country_event = { id = ideagroups.1 } #Swap Ideas
		}
		
		#Disable decision
		set_country_flag = formed_occitania_flag
	}
	ai_will_do = {
		factor = 1
	}
	ai_importance = 400 #
}

}