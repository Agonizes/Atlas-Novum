namespace = IR_flavor_HAB
	
country_event = {
	id = IR_flavor_HAB.1
	title = "IR_flavor_HAB.1.t"
	desc = "IR_flavor_HAB.1.d"
	picture = COURT_eventPicture

	fire_only_once = yes

	trigger = {
		OR = {
		tag = HAB
		tag = STY
		}
		is_year = 1455
		not = { is_year = 1460 }
		HAB = { has_ruler = "Ladislaus Postumus" }
	}

	mean_time_to_happen = {
		months = 30
	}
		
	option = {
		name = "IR_flavor_HAB.1.a"
	}
	immediate = {
		hidden_effect = {
		if = { limit = { OR = { AND = { tag = HAB ai = yes } tag = STY } } 
			HAB = { kill_ruler = yes } 
			HUN = { if = { limit = { has_ruler = "Ladislaus Postumus" } kill_ruler = yes 
				define_ruler = {
				name = "Mátyás"
				dynasty = Corvin
				#birth_date = 1443.2.23	
				culture = ROOT
				religion = ROOT
				adm = 4
				dip = 5
				mil = 5
				} }
			}
			BOH = { if = { limit = { has_ruler = "Ladislaus Postumus" } kill_ruler = yes 
				define_ruler = {
				name = "Jirí"
				dynasty = "z Podebrad"
				#birth_date = 1420.4.23
				adm = 5
				dip = 4
				mil = 3
				culture = ROOT
				religion = ROOT
				} }
			}
			STY = { 
				inherit = HAB
			}
			set_capital = 134
		}
		if = { limit = { tag = HAB ai = no } 
			HAB = { 
				inherit = STY
					define_ruler = {
					name = "Friedrich III"
					dynasty = "von Habsburg"
					#birth_date = 1415.9.21
					adm = 2
					dip = 5
					mil = 1
					culture = ROOT
					religion = ROOT
					}
					define_consort = {
					country_of_origin = POR
					name = "Eleanor"
					dynasty = "de Avis"
					birth_date = 1434.9.18
					#death_date = 1467.9.3
					female = yes
					adm = 2
					dip = 2
					mil = 1
					}
				}
			}
		}
	}
}

country_event = {
	id = IR_flavor_HAB.2
	title = "IR_flavor_HAB.2.t"
	desc = "IR_flavor_HAB.2.d"
	picture = COURT_eventPicture

	fire_only_once = yes

	trigger = {
		tag = TIR
		is_year = 1485
	}

	mean_time_to_happen = {
		months = 60
	}
		
	option = { #Duke of Tirol abdicates and Austria inherits Tirol
		name = "IR_flavor_HAB.2.a"
		ai_chance = { factor = 90 }
		HAB = { inherit = TIR }
	}
	option = { #A-historical - Dont accept revolters demands
		name = "IR_flavor_HAB.2.b"
		ai_chance = { factor = 10 }
		random_owned_province = {	
			spawn_rebels = {	
				type = noble_rebels	size = 2 #leader = rebel_preacher
			}
		}
	}
}

country_event = { #Full Release of Ladislaus from Styria
	id = IR_flavor_HAB.X
	title = "IR_flavor_HAB.X.t"
	desc = "IR_flavor_HAB.X.d"
	picture = COURT_eventPicture
	
	#hidden = yes
	major = yes
	is_triggered_only = yes
	
	option = { 
		name = IR_flavor_HAB.X.a
		ai_chance = { factor = 100 }
	}
	
	immediate = {
		#hidden_effect = {
			HAB = { 
				grant_independence = yes
				define_ruler = {
						name = "Regent Ulrich II"
						dynasty = "Celje"
						regency = yes
						culture = slovene
						religion = ROOT
						adm = 5
						dip = 6
						mil = 4
						fixed = yes
				}
				create_union = HUN
				create_subject = {
					subject_type = fief
					subject = CLJ
				}
				add_historical_rival = POL
				add_historical_rival = STY
				add_country_modifier = {
					name = IR_austrian_unions
					duration = 3650
				}
			}
			HUN = {
				add_country_modifier = {
					name = IR_hungary_austrian_liberty
					duration = 3650
				}
			}
		#}
		set_country_flag = IR_flavor_HAB.X.happened
	}
}

country_event = {
	id = IR_flavor_HAB.3
	title = "IR_flavor_HAB.3.t"
	desc = "IR_flavor_HAB.3.d"
	picture = COURT_eventPicture

	trigger = {
		tag = STY
		is_year = 1450
		not = { is_year = 1460 }
		HAB = { 
			has_regency = yes 
			is_subject_of = STY
			estate_influence = {
				estate = estate_nobles
				influence = 50
			}
		}
	}

	mean_time_to_happen = {
		months = 30
	}
		
	option = { #Refuse to release Ladislaus
		name = "IR_flavor_HAB.3.a"
		HAB = { 
			random_owned_province = {	
				spawn_rebels = {	
				type = noble_rebels	size = 2 #leader = rebel_preacher
				}
			}
		}
		STY = { 
			random_owned_province = {
				spawn_rebels = {	
				type = noble_rebels	size = 2 #leader = rebel_preacher
				}
			}
		}
		set_country_flag = IR_flavor_HAB.3.a.happened
	}
	option = { #Frederick is no longer regency in HAB
		name = "IR_flavor_HAB.3.b"
		country_event = { id = IR_flavor_HAB.X days = 1 }
		#custom_tooltip =
	}
}

country_event = { #Nobles force the release
	id = IR_flavor_HAB.4
	title = "IR_flavor_HAB.4.t"
	desc = "IR_flavor_HAB.4.d"
	picture = COURT_eventPicture

	trigger = {
		tag = STY
		has_rebel_faction = noble_rebels
		has_country_flag = IR_flavor_HAB.3.a.happened
		HAB = { 
			num_of_rebel_controlled_provinces = 5
		}
		134 = { controlled_by = REB }
	}

	mean_time_to_happen = {
		months = 1
	}

	option = { #Frederick is no longer regency in HAB
		name = "IR_flavor_HAB.4.a"
	}
	immediate = {
		country_event = { id = IR_flavor_HAB.X days = 1 }
	}
}

country_event = {
	id = IR_flavor_HAB.5
	title = "IR_flavor_HAB.5.t"
	desc = "IR_flavor_HAB.5.d"
	picture = COURT_eventPicture

	trigger = {
		tag = HAB
		not = { is_year = 1460 }
		has_regency = yes 
		has_heir = "Ladislaus Postumus"
		NOT = { 
			is_subject = yes 
			has_country_flag = IR_flavor_HAB.X.happened
		}
	}

	mean_time_to_happen = {
		months = 30
	}

	option = { #Frederick is no longer regency in HAB
		name = "IR_flavor_HAB.5.a"
	}
	immediate = {
		country_event = { id = IR_flavor_HAB.X days = 1 }
	}
}

# Diet of 1446
country_event = {
	id = IR_flavor_HAB.6
	title = IR_flavor_HAB.6.t
	desc = IR_flavor_HAB.6.desc
	picture = DEBATE_REPUBLICAN_eventPicture
	
	fire_only_once = yes

	trigger = {
		tag = HUN
		has_regency = yes
		has_consort_regency = no
		is_lesser_in_union = no
		has_leader = "János Hunyadi"
		is_year = 1446
		NOT = { is_year = 1470 }
		has_government_attribute = heir
	}
	
	mean_time_to_happen = {
		months = 3
	}
	
	option = {
		ai_chance = { factor = 50 }
		name = IR_flavor_HAB.6.a
		define_ruler = {
			name = "Regent János Hunyadi"
			DIP = 5			
			ADM = 4
			MIL = 5
			fixed = yes
			regency = yes
			attach_leader = "János Hunyadi"
		}
		if = {
			limit = {
				has_states_general_mechanic = yes
			}
			change_statists_vs_orangists = 1
		}
		if = {
			limit = {
				has_dlc = "Rights of Man" 
			}
			hidden_effect = { add_ruler_personality = bold_fighter_personality }
		}
		set_country_flag = IR_flavor_HAB.6.happened
	}
	option = { #time to change
		name = IR_flavor_HAB.6.b
		ai_chance = { factor = 30 }
		define_ruler = {
			culture = ROOT
			religion = ROOT
		}
		remove_heir = yes
		every_country = {
			limit = {
				NOT = { tag = ROOT }
				dynasty = "von Habsburg"
			}
			add_opinion = {
				who = root
				modifier = hun_habsburgs_spurned
			}				
		}
	}
	option = {
		name = IR_flavor_HAB.6.c
		ai_chance = { factor = 20 }
		add_stability_or_adm_power = yes
		#define_heir = {
		#	name = "Ladislaus Postumus"
		#	dynasty = "von Habsburg"
		#	culture = austrian
		#	adm = 1
		#	dip = 2
		#	mil = 1
		#	birth_date = 1440.2.22
		#}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -15
		}
	}
}

#Hungarian Demands of Ladislaus
country_event = {
	id = IR_flavor_HAB.7
	title = IR_flavor_HAB.7.t
	desc = IR_flavor_HAB.7.d
	picture = DEBATE_REPUBLICAN_eventPicture
	
	fire_only_once = yes
	#could allow it to fire more than once, but for sake of forcing history.

	trigger = {
		tag = HUN
		has_country_flag = IR_flavor_HAB.6.happened
		HAB = {
			has_regency = yes 
			has_heir = "Ladislaus Postumus"
		}
		NOT = {
			has_country_flag = IR_flavor_HAB.X.happened
		}
	}
	
	mean_time_to_happen = {
		months = 6
	}
	
	option = { #Demand Frederick III to end Ladislaus Regency.
		ai_chance = { factor = 50 }
		name = IR_flavor_HAB.7.a
		STY = {
			country_event = { id = IR_flavor_HAB.8 days = 1 }
		}
		add_prestige = 5
		tooltip = {
			declare_war = STY
		}
	}
	option = { #Its not in our best interest.
		name = IR_flavor_HAB.7.b
		ai_chance = { factor = 50 }
		add_prestige = -5
	}
}

#Hungarian Demands over Ladislaus
country_event = {
	id = IR_flavor_HAB.8
	title = IR_flavor_HAB.8.t
	desc = IR_flavor_HAB.8.d
	picture = DEBATE_REPUBLICAN_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		tag = STY
	}
	
	mean_time_to_happen = {
		months = 6
	}
	
	option = { #Refuse to Release
		ai_chance = { factor = 75 }
		name = IR_flavor_HAB.8.a
		HUN = {
			declare_war = STY
		}
		CLJ = {
			#add_claim
		}
	}
	option = { #Release Ladislaus
		name = IR_flavor_HAB.8.b
		ai_chance = { factor = 25 }
		country_event = { id = IR_flavor_HAB.X days = 1 }
		add_prestige = -5
	}
}